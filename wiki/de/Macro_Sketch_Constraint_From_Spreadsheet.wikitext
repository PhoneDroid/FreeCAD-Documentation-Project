<languages/>

{{Macro/de
|Name=Skizzen-Beschränkungen aus Kalkulationstabellen
|Description=Makro, das mit einem einfachen Klick in die Zelle einer Kalkulationstabelle eine Längen-Beschränkung zu einer Linie, einem Kreis, oder zwischen zwei Punkten, mit einem Alias oder einer Adresse (bspw. C2) hinzufügt. Änderungen an der Kalkulationstabelle ändern die Beschränkung. Das Makro erzeugt die Alias.<br>Wähle eine Linie, zwei Punkte oder eine Beschränkung, klicke auf eine Tabellenzelle und führe das Makro aus. Es können Linien, Punkte am Ende der Line, Punkte, Kreise oder Bögen von Kreisen ausgewählt werden.
|Author=2cv001
|Download=[https://wiki.freecad.org/images/d/dc/Macro_Sketch_Constraint_From_Spreadsheet.svg ToolBar icon]
|Version=01.10
|Date=2025-02-28
|FCVersion=Alle
}}

<span id="Description"></span>
== Beschreibung ==

'''Kontaktiere mich bei Problemen im FreeCAD-Forum.'''

Makro, das mit einem einfachen Klick in die Zelle einer Kalkulationstabelle eine Längen-Beschränkung zu einer Linie, einem Kreis, oder zwischen zwei Punkten, mit einem Alias oder einer Adresse (bspw. C2) hinzufügt. Änderungen an der Kalkulationstabelle ändern die Beschränkung. Das Makro erzeugt die Alias.

Wähle eine Linie, zwei Punkte oder eine Beschränkung, klicke auf eine Tabellenzelle und führe das Makro aus. Es können Linien, Punkte am Ende der Line, Punkte, Kreise oder Bögen von Kreisen ausgewählt werden.

[[File:SketchConstraintFromSpreadsheet1.gif]]

{{Codeextralink|https://raw.githubusercontent.com/2cv001/FreeCAD-macros/master/Spreadsheet/Sketch_Constraint_From_Spreadsheet.FCMacro}}

<span id="Usage"></span>
== Anwendung ==

<span id="Automatic_Object_creation"></span>
=== Automatische Objekt-Erzeugung ===

Wenn das Makro ausgeführt wird bevor eine Kalkulationstabelle, ein Körper oder eine Skizze erstellt wurde, schlägt das Makro vor eine zu erstellen. Anschließend wird die Skizze im Bearbeitungsmodus und die Kalkulationstabelle geöffnet, so dass sie ausgefüllt werden kann.

[[File:SketchConstraintFromSpreadsheet7.gif]]

<span id="Automatic_Alias_creation"></span>
=== Automatische Alias-Erzeugung ===

Es ist nicht verpflichtend, aber besser, Alias in der Kalkulationstabelle zu nutzen. Das Makro kann Alias aus Texten der Zellen erzeugen.<br>
Zwei Modi:
* Manueller Modus, bei dem die Zellen mit dem Alias-Text selbst ausgewählt werden müssen und der Automatikmodus.
* und der Automaktikmodus:

<span id="Automatic_mode"></span>
==== Automatik-Modus ====

<div lang="en" dir="ltr" class="mw-content-ltr">
An automatic mode where alias are automatically created using a text zone defined by a cell. The zone includes the cell and those below. These texts correspond to the alias name. The alias is created to the right of its text. The designated cell (here A3) is editable in these dialog boxes:
</div>

[[File:SketchConstraintFromSpreadsheet2302.png|alt=Alias automatic creation|Alias automatic creation]]

[[File:SketchConstraintFromSpreadsheet2303.png|alt=Alias automatic creation|Alias automatic creation]]
[[File:SketchConstraintFromSpreadsheet2304.gif|alt=Alias automatic creation|Alias automatic creation]]
<br>


<span id="Manual_mode"></span>
==== Manueller Modus ====

Um den manuellen Modus zu nutzen, aktiviere die Option "Automatischer Alias".

[[File:SketchConstraintFromSpreadsheet2301.png|alt=Alias creation|Alias creation]]

[[File:SketchConstraintFromSpreadsheet8.gif|alt=Alias creation|Alias creation]]

<span id="Constraints_creation"></span>
=== Beschränkungen erzeugen ===

<div lang="en" dir="ltr" class="mw-content-ltr">
1) Select:
* a line,
* two points (end of a line, center of a circle, etc.)
* or a length constraint.
</div>

[[File:SelectPoints.png]]

<div lang="en" dir="ltr" class="mw-content-ltr">
2) Click on a spreadsheet cell, with or without an alias, that has a numerical value:
</div>

[[File:Capture1.png]]

<div lang="en" dir="ltr" class="mw-content-ltr">
3) Run the macro.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
4) Select the desired type of constraint:
</div>

[[File:Choose type of constraint.png]]

<div lang="en" dir="ltr" class="mw-content-ltr">
If the cell has an alias, the length property of the constraint will be something like 'Spreadsheet.alias'. Otherwise, something like 'Spreadsheet.D4'.
</div>

[[File:If_the_spreadsheet_has_an_alias.png]]

<div lang="en" dir="ltr" class="mw-content-ltr">
5) If the constraint causes a conflict in the sketch and the "conflict detection" box is checked, the macro will offer to delete the new constraint:
</div>

[[File:SketchConstraintFromSpreadsheet3.gif]]

<div lang="en" dir="ltr" class="mw-content-ltr">
If you select an existing constraint, you can change its value for a value from a spreadsheet:
</div>

[[File:SketchConstraintFromSpreadsheet2.gif]]
[[File:SketchConstraintFromSpreadsheet4.gif]]

<div lang="en" dir="ltr" class="mw-content-ltr">
The macro can also handle external geometry from another sketch:
</div>
[[File:SketchConstraintFromSpreadsheet9.gif]]

<div lang="en" dir="ltr" class="mw-content-ltr">
To make things even more refined, if, for example, a line is horizontal rather than vertical, when the dialogue box opens, the focus will be on the button for apply a horizontal constraint. If the line is vertical rather than horizontal, the focus will be on the button to apply a vertical constraint. In both cases, simply press the enter key if you are happy with this choice.
</div>


[[File:SketchConstraintFromSpreadsheet5.gif]]

<div lang="en" dir="ltr" class="mw-content-ltr">
The macro also works for Pads (property Length), Pockets (property Length), Fillets (property Radius), Chamfers (property Size) and Thicknesses (property Value). If you click on a Pad, for example, and then on a cell with the desired value, the Length property of the pad is automatically modified.
</div>
<br>

[[File:SketchConstraintFromSpreadsheet20240801.gif]]

<span id="Links"></span>
== Verweise ==

* [https://forum.freecad.org/viewtopic.php?t=75972 Diskussion im Forum (Französisch)]
* [https://forum.freecad.org/viewtopic.php?style=5&t=76990 Diskussion im Forum (Englisch)]
* [[Macros_recipes/de|Macrorezepte]]
* [[How_to_install_macros/de|Wie man Makros installiert]]
* [[Customize_Toolbars/de|Anpassung der Werkzeugleisten]]

<span id="Credits"></span>
== Danksagung ==

<div lang="en" dir="ltr" class="mw-content-ltr">
Thanks to openBrain, mario52 and onekk for their help on the code!<br/>
Thanks to Syres	for tests, reviews and help in the code.<br/>
Thanks to Roy043 and David69 for the various reviews and improvements to the wiki.<br/>
Thanks to L'ami René for tests and ideas.
</div>

<span id="Script"></span>
== Skript ==

<div lang="en" dir="ltr" class="mw-content-ltr">
ToolBar Icon [[Image:Macro_Sketch_Constraint_From_Spreadsheet.svg]]
</div>

=== Code ===

ver 01.10 2025/02/28 by 2cv001 '''Macro_Sketch_Constraint_From_Spreadsheet.FCMacro'''
<span id="Download"></span>
==== Herunterladen ==== 
<br>
{{CodeDownload|https://raw.githubusercontent.com/2cv001/FreeCAD-macros/master/Spreadsheet/Sketch_Constraint_From_Spreadsheet.FCMacro| Download latest version of the macro}}