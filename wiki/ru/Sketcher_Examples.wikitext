{{UnfinishedDocu{{#translation:}}}}
<languages/>

{{TOCright}}

<span id="Introduction"></span>
== Введение ==

Я думаю, что [[Image:Workbench_Sketcher.svg|24px]] [[Sketcher_Workbench/ru|Верстак Скетчер]] нуждается в некоторых примерах, которые не являются подробными руководствами или видео...

<span id="Film_hinge"></span>
== Плёночный шарнир ==

Плёночный шарнир - это крошечный кусочек гнущегося пластика, который соединяет две стороны предмета, изготовленного методом литья под давлением, например, ёмкость с крышкой или две половинки корпуса пылезащитной пробки.

В этом примере используется некий мастер-эскиз, на который накладываются несколько зависимых эскизов. Он также показывает, как прикрепить и анимировать простой зажим на основе функций верстака [[Image:Workbench_PartDesign.svg|16px]] [[PartDesign_Workbench/ru|ПроектнаяДеталь (PartDesign)]] и ограничений из верстака [[Image:Workbench_Sketcher.svg|16px]] [[Sketcher_Workbench/ru|Скетчер (Sketcher)]]. Использование [[Image:Bound-expression.svg|16px]] [[Expressions/ru|выражений]], как описано ниже, требует FreeCAD '''V 0.21 или выше'''.

<span id="Basic_sketch"></span>
===Базовый эскиз===

Обычно объект моделируется в закрытом состоянии. Позже подвижную часть необходимо развернуть на 180° для формовки в открытом состоянии.<br>Сгибаемая полоса представлена круговой дугой для закрытого состояния и прямой линией для открытого состояния, обе имеют одну и ту же начальную точку.<br>Средняя точка линии, соединяющей обе конечные точки, указывает положение оси переворота, нормальной к плоскости эскиза. (Она помещается в начало эскиза, чтобы глобальная ось, нормальная к плоскости эскиза, могла использоваться в качестве оси вращения)

 <div class="mw-collapsible mw-collapsed">
(Некоторые скрытые дополнительные пояснения и описание рабочего процесса можно найти здесь --> 

[[Image:Sketcher_ExampleHinge-01.gif|400px]]
{{Caption|Мастер-эскиз и анимированная петля плёночного шарнира (щёлкните по изображению, если анимация остановилась после нескольких повторов)}}

<div class="mw-collapsible-content toccolours">

Для полуокружности длина дуги равна радиусу, умноженному на Pi ('''l = r * Pi'''). Радиус называется NeutralRadius (НейтральныйРадиус), а линия - DevelopedLength (ДлинаРазвёртки). Выражение для DevelopedLength связывает оба значения: {{incode|.Constraints.NeutralRadius * pi}}
: В пределах одного эскиза выражение начинается с {{incode|.}}, за которым следует ValueType.ValueName для обращения к другому значению.

</div> <!-- End of collapsible element for content section. Do not remove! -->

<span id="Intermediate_sketch"></span>
===Промежуточный эскиз===

Дуга этого плёночного шарнира имеет постоянную длину и переменный радиус. Одним из исходных данных является NeutralRadius базового эскиза; чтобы иметь его под рукой в этом эскизе, он связан как [[Image:Sketcher_External.svg|16px]] [[Sketcher_External/ru|внешняя геометрия]], имеющая опорный размер ReferenceRadius

<div class="mw-collapsible-content toccolours">

Круговой сегмент вспомогательной геометрии показывает соотношение между дугой и радиусом для заданного угла.<br>
'''InputLength = ReferenceRadius * Pi''' <br>
и<br>
'''ArcLength = DynamicRadius * Pi * ArcAngle / 180°''' <br>
при постоянной длине это приводит к:<br>
'''ReferenceRadius * Pi = DynamicRadius * Pi * ArcAngle / 180°''' <br>
И, исключив Pi, получаем:<br>
'''ReferenceRadius  = DynamicRadius * ArcAngle / 180°''' или '''DynamicRadius  = ReferenceRadius  * 180° / ArcAngle'''
: [[Image:Bound-expression.svg|16px]] [[Expressions/ru|Выражение]] для значения DynamicRadius : {{incode|.Constraints.ReferenceRadius * 180 ° / .Constraints.ArcAngle}}

Плёночный шарнир обычно симметричен, поэтому для вывода используется другая дуга с той же центральной точкой, называемая HalfArc и представляющая собой половину дуги шарнира.
: [[Image:Bound-expression.svg|16px]] [[Expressions/ru|Выражение]] для значения HalfArc : {{incode|.Constraints.ArcAngle / 2}}

</div> <!-- End of collapsible element for content section. Do not remove! -->

[[Image:Sketcher_ExampleHinge-02.png|400px]]
{{Caption|Промежуточный эскиз, показывающий DynamicRadius дуги шарнира 4 (мм) при заданном угле 45° (и полудуги для вывода)}}

<span id="Film_hinge_sketch"></span>
=== Эскиз петли для крепления плёнки ===

Этот эскиз определяет толщину и прилегающую геометрию плёночного шарнира. Поэтому мы загружаем полудугу промежуточного эскиза как внешнюю геометрию, чтобы использовать её в качестве основы для плёночной части. (в данном случае это доля 180°)

Эта плёночная петля предназначена для того, чтобы соединённые части не касались друг друга в закрытом состоянии. Этого можно добиться, рассчитав круговую дугу нужной длины, затем создав полоску постоянной толщины и, наконец, наложив галтели в местах соприкосновения полоски с половинками объекта. Последний шаг укорачивает петлю, но в реальном мире это не проблема, поскольку дуга никогда не будет круглой, а галтели влияют на кривизну дуги, но не на её функциональность.

[[Image:Sketcher_ExampleHinge-03.png|400px]]
{{Caption|Эскиз шарнира, показывающий очертания шарнира на основе внешней геометрии по полудуге промежуточного эскиза}}


[[Image:Sketcher_ExampleHinge-04.png|300px]] 
[[Image:Sketcher_ExampleHinge-05.png|300px]]
{{Caption|Слева: [[Image:PartDesign_Pad.svg|16px]] [[PartDesign_Pad/ru|выдавленная]] половинка петли с видимым эскизом. Справа: полупетля с добавленым [[Image:PartDesign_Fillet.svg|16px]] [[PartDesign_Fillet/ru|скруглением]]}}


[[Image:Sketcher_ExampleHinge-06.png|300px]] [[Image:Button_right.svg|16px|link=]] 
[[Image:Sketcher_ExampleHinge-07.png|300px]]
{{Caption|Полупетля с выделенной зеркальной плоскостью → [[Image:PartDesign_Mirrored.svg|16px]] [[PartDesign_Mirrored/ru|зеркальная]] плёночная петля}}


Подсказка: Функция [[Image:Part_Mirror.svg|16px]] [[Part_Mirror/ru|Деталь Зеркально]] принимает только три основные плоскости и поэтому не может быть использована в данном случае.
: (Оглядываясь назад, можно сказать, что было мудрым решением начать этот пример с комбинации ПроектнаяДетаь (PartDesign) и Скетчер (Sketcher)).


Наконец, два параметра определяют размер плёночного шарнира:
* NeutralRadius основного эскиза
* значение толщины плёнки в эскизе петли

<span id="Bending_the_film_hinge"></span>
===Сгибание плёночного шарнира===

Угол изгиба контролируется ограничением ArcAngle промежуточного эскиза и может быть изменён в его редакторе свойств.<br> Но мы же с вами - правильные дизайнеры и правильно назвали ограничения и размеры наших эскизов, поэтому можем обратиться к контрольному углу через Python.<br> Несколько основных строк кода для встраивания в контекст GUI могут выглядеть следующим образом:

{{Code|code=
doc=App.ActiveDocument
sketch=doc.getObjectsByLabel('IntermediateSketch')[0]
 ...
sketch.getDatum('ArcAngle')
 ...
sketch.setDatum('ArcAngle',App.Units.Quantity('50.000000 deg'))
doc.recompute(None,True,True)
}}  

<div class="mw-collapsible-content toccolours">

Краткое объяснение:
* {{Incode|doc {{=}} App.ActiveDocument}}: Чтобы обратиться к активному документу по псевдониму, называемому '''doc'''
*{{Incode|sketch {{=}} doc.getObjectsByLabel('IntermediateSketch')[0]}}: Чтобы обратиться к соответствующему эскизу под псевдонимом '''sketch'''.
*: Метод '''getObjectsByLabel()''' возвращает список объектов, и мы должны использовать суффиксный индекс {{value|0}}, чтобы выбрать первый объект в списке. (Мы не ожидаем появления другого объекта с такой же меткой и поэтому не должны заботиться о других элементах в списке.)
* {{Incode|sketch.getDatum('ArcAngle')}}: Возвращает текущее значение размерного ограничения '''ArcAngle''' (в режим просмотра отчета)
* {{Incode|sketch.setDatum('ArcAngle', App.Units.Quantity('50.0 deg'))}}: Устанавливает значение '''ArcAngle''' {{value|50°}} 
* {{Incode|doc.recompute(None,True,True)}}: Чтобы обновить весь документ и показать изменения зависимой геометрии.

</div> <!-- End of collapsible element for content section. Do not remove! -->

<span id="Connecting_geometry"></span>
===Присоединяем геометрию===

Две половинки клипсы ждут своего часа, чтобы быть прикреплёнными к шарниру: одна на неподвижной стороне, другая - на подвижной.

[[Image:Sketcher_ExampleHinge-08.png|300px]]
{{Caption|Две половинки простого зажима}}

<div class="mw-collapsible-content toccolours">

<div lang="en" dir="ltr" class="mw-content-ltr">
The static side is easy: 
# Activate the body and adjust the position and orientation properties in the properties editor until it matches with the film hinge.
# Activate the hinge body.
# Select the [[Image:PartDesign_Boolean.svg|16px]] [[PartDesign_Boolean|PartDesign Boolean]] tool with the (default) Fuse option.
# In the dialog press the {{Button|Add body}} button.
# select the '''body''' of the static half of the clip.
# Press OK to finish and close the dialog.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
</div> <!-- End of collapsible element for content section. Do not remove! -->
</div>

[[Image:Sketcher_ExampleHinge-09.png|300px]] [[Image:Button_right.svg|16px|link=]] 
[[Image:Sketcher_ExampleHinge-10.png|300px]]
<div lang="en" dir="ltr" class="mw-content-ltr">
{{Caption|Film hinge and static half in modelling position → film hinge with relocated and [[Image:PartDesign_Boolean.svg|16px]] [[PartDesign_Boolean|fused]] static half}}
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
<div class="mw-collapsible-content toccolours">
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
But the moving side is different: The related half of the clip geometry has to move into the right position before a (re-) calculation of a Fuse operation gets started.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
At this point I'm missing an "Attachment with offset" function like that of Assembly3 to attach the clip geometry to one of the moving faces. But after a bit of experimenting and tweaking I found out:
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
* [[Image:Std_Part.svg|16px]] [[Std_Part|Std Part]] and [[Image:PartDesign_Body.svg|16px]] [[PartDesign_Body|PartDesign Body]] containers are not supported by [[Image:Part_EditAttachment.svg|16px]] [[Part_EditAttachment#Limitations|Part Attachment]]. 
:While it is possible to use Attachment to align them, the attachment won't be parametrically linked.
* Attachment can be applied to a PartDesign feature. This and features depending on it are repositioned according to the base geometry. But!:
** Independent PartDesign features won't move and so it will change the resulting shape and break it in the end.
** We are advised to keep features independent to avoid impacts due to the [[Topological_naming_problem|Topological naming problem]].
* [[File:PartDesign_Clone.svg|16px]] [[PartDesign_Clone|PartDesign Clone]] creates a body with a single feature that can be use with Attachment.
</div>


<div lang="en" dir="ltr" class="mw-content-ltr">
With that in mind, a workflow could look like this:
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
# Select the body of the movable half.
# Use the [[File:PartDesign_Clone.svg|16px]] [[PartDesign_Clone|Create a clone]] command.
# In the new body select the Clone object in the Tree view.
# Use the [[Image:Part_EditAttachment.svg|16px]] [[Part_EditAttachment|Part Attachment]] tool to add attachment properties to the Clone object.
# The Attachment dialog opens.
#* Select a vertex for the origin.
#* Select an edge for the first direction.
#* Select an edge for the second direction.
#* Probe the attachment modes to find the best fitting one.
#* Tweak rotation and coordinate values until until the geometry is in modelling position again.
# Press OK to close the dialog.
# With the hinge body still active select the [[Image:PartDesign_Boolean.svg|16px]] [[PartDesign_Boolean|PartDesign Boolean]] tool.
# In the dialog press the {{Button|Add body}} button.
# select the body of the movable half .
# Press OK to finish and close the dialog.
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
</div> <!-- End of collapsible element for content section. Do not remove! -->
</div> <!-- End of collapsible element for ... section. Do not remove! -->
</div>

[[Image:Sketcher_ExampleHinge-14.png|300px]]
<div lang="en" dir="ltr" class="mw-content-ltr">
{{Caption|The movable half will be [[Image:Part_EditAttachment.svg|16px]] [[Part_EditAttachment|attached]] to a corner of the movable hinge side (Map Mode OXZ: vertex, edge, edge)}}
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
In retrospect it would have been wiser to provide the attachment geometry with the IntermediateSketch to avoid another source of the [[Topological_naming_problem|Topological naming problem]].
</div>

[[Image:Sketcher_ExampleHinge-11.png|300px]] [[Image:Button_right.svg|16px|link=]] 
[[Image:Sketcher_ExampleHinge-12.png|300px]]
<div lang="en" dir="ltr" class="mw-content-ltr">
{{Caption|The clip so far and the movable half in modelling position → finished clip with [[Image:Part_EditAttachment.svg|16px]] [[Part_EditAttachment|attached]] and [[Image:PartDesign_Boolean.svg|16px]] [[PartDesign_Boolean|fused]] movable half}}
</div>

<div lang="en" dir="ltr" class="mw-content-ltr">
Now the result should be a single solid clip, that can be closed and opened by changing the ArcAngle of the film hinge. Allowed angles: 0.1° to 180°, the film section must not get straight, and more than closed doesn't make sense. (At 180° the object may get fused at tangent or overlapping areas, but a little extra gap could help if that is not acceptable.)
</div>

[[Image:Sketcher_ExampleHinge-13.png|200px]] [[Image:Button_right.svg|16px|link=]] 
[[Image:Sketcher_ExampleHinge-15.png|200px]] [[Image:Button_right.svg|16px|link=]] 
[[Image:Sketcher_ExampleHinge-16.png|200px]]
<div lang="en" dir="ltr" class="mw-content-ltr">
{{Caption|Clip almost closed → Clip half closed → Clip in mould condition}}
</div>

{{PartDesign Tools navi{{#translation:}}}}
{{Sketcher Tools navi{{#translation:}}}}
{{Userdocnavi{{#translation:}}}}