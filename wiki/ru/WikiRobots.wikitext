<languages/>
{{VeryImportantMessage|Роботы опасны по своей сути, так как могут автоматически причинить много вреда. Используйте их с особой осторожностью!}}

<span id="Overview"></span>
==Обзор==

Повторяющиеся задачи можно автоматизировать с помощью роботов или ботов, то есть программ, самостоятельно работающих в вики.

Естественные и наиболее часто используемые роботы для вики-сайтов предоставляются MediaWiki под названием Pywikibot. Полную информацию смотри в [http://www.mediawiki.org/wiki/Manual:Pywikibot Руководство:Pywikibot].

В двух словах, Pywikibot - это набор скриптов на Python, способных использовать родной API вики для работы с вики-сайтами. Список API для вики FreeCAD можно посмотреть на сайте http://www.freecadweb.org/wiki/api.php.

Для того чтобы использовать Pywikibot, вам необходимо:

# установите пакет Pywikibot
# настройте Pywikibot для работы с FreeCAD Wiki
# запустите скрипты, необходимые для выполнения поставленной задачи

Существует множество информации о том, как устанавливать, настраивать и использовать Pywikibot. Однако помните, что эта информация, хотя и полезная, может вводить в заблуждение, поскольку в ней смешаны инструкции, относящиеся к двум разным кодовым базам Pywikibot и разным версиям коллекции скриптов Pywikibot.

Ниже вы найдёте основные инструкции по настройке и использованию Pywikibot в FreeCAD wiki. Это позволит вам выполнять самые распространённые задачи. Для более продвинутого использования обратитесь к [http://www.mediawiki.org/wiki/Manual:Pywikibot Руководству:Pywikibot], а также к исходному коду на Python.

<span id="Installation"></span>
==Установка==

Зайдите на http://tools.wmflabs.org/pywikibot/ и скачайте {{FileName|package/pywikipedia/core.zip}} (проект также находится на github, gerrit и т. д., но это простой способ получить полный автономный пакет).

Распакуйте содержимое в нужный вам каталог.

Если вы не хотите устанавливать библиотеки в папку Python libs, вы закончили (если вы всё ещё хотите установить их, проверьте файл {{FileName|INSTALL}} в базовом каталоге).

Pywikibot работает с Python 2.6 и 2.7 без каких-либо проблем. Python 3 <s> до сих пор не тестировался с FreeCAD wiki</s> также работает.

<span id="Configuration"></span>
==Настройка==

You must save the following Python code as a file with the name {{FileName|user-config.py}} in the base directory where you unzipped {{FileName|package/pywikipedia/core.zip}} (to be clear, in the same directory where you already find a file called {{FileName|user-config.py.sample}}).

{{Code|code=
# -*- coding: cp437  -*-
family = 'freecadwiki'
mylang = 'en'
usernames['freecadwiki']['en'] = u'<<yourWikiUserName>>'
#usernames['freecadwiki']['freecadwiki'] = u'<<yourWikiUserName>>'
console_encoding = 'cp437'
}}

In the above code:

* replace ''<<yourWikiUserName>>'' with your Wiki user name
* replace ''cp437'' with your ''console_encoding''. To find out what is your console encoding, for Windows and Linux, launch the Python interpreter, enter {{SystemInput|import sys}} followed by {{SystemInput|print sys.stdout.encoding}}. Python will write your {{SystemOutput|console_encoding}} on the screen.


Then you must save the following Python code as a file with the name {{FileName|freecadwiki_family.py}} under the sub-directory {{FileName|/pywikibot/families}} (together with the other {{FileName|family_xxx.py}} files).

{{Code|code=
# -*- coding: utf-8  -*-

__version__ = '$Id: 7f3891c3bbbfbd69c0b005de953514803d783d92 $'

from pywikibot import family


# The MediaWiki family
# user-config.py: usernames['mediawiki']['mediawiki'] = 'User name'
class Family(family.WikimediaFamily):
    def __init__(self):
        super(Family, self).__init__()
        self.name = 'freecadwiki'

        self.langs = {
            'en': 'www.freecadweb.org',
        }

    def scriptpath(self, code):
        return 'wiki'

    def path(self, code):
        return '/index.php' #The path of index.php, look at your wiki address. 
	 
    def apipath(self, code):
        return '/api.php' #The path of api.php

    def version(self, code):
        # Replace with the actual version being run on your wiki
        return '1.20.3'

    def protocol(self, code):
        """
        Can be overridden to return 'https'. Other protocols are not supported.
        """
        return 'http'
        #return 'https' # My server uses https
}}

<span id="Usage"></span>
==Применение==

You are now all set to launch the Pywikibot scripts. The scripts themselves are contained in the {{FileName|/scripts}} subdirectory, from which you can know the names.

To launch the scripts, open a shell and move to the base directory (the installation one, NOT the {{FileName|/scripts}} subdirectory), and write

{{SystemInput|python pwb.py <<scriptname>>.py -<<parameter>>}}

where of course you replace ''<<scriptname>>'' with the name of the script you are interested in, and ''<<parameter>>'' with the parameter(s) required for the given script.

To have a description of the usage and parameters of any script, simply use the ''-help'' parameter. For instance, to have a description of the {{FileName|replace.py}} script (one of the most useful), type

{{SystemInput|python pwb.py replace.py -help}}

There is another very useful parameter, valid for all the scripts, called ''-simulate'', that allows you to test commands without harming the Wiki. Use it, before going 'live'.

<span id="Examples"></span>
==Примеры==

This command will log into the wiki

{{SystemInput|pwb.py login.py}}


This command will print a list of all the pages containing a link to SourceForge

{{SystemInput|pwb.py listpages.py -weblink:sourceforge.net}}


This command will replace all the links to the old SourceForge Forum with a link to the new freecad.org-hosted Forum

{{SystemInput|pwb.py replace.py -weblink:sourceforge.net/apps/phpbb/free-cad "sourceforge.net/apps/phpbb/free-cad" "forum.freecad.org"}}


This command will print a list of all the pages containing the word 'PartDesign', starting with the page titled "2d Drafting Module" and going on alphabetically

{{SystemInput|pwb.py listpages.py -start:"2d Drafting Module" -grep:PartDesign}}


This command will replace all the secure links to the old SourceForge Forum with a link to the new freecad.org-hosted Forum in the translated pages

{{SystemInput|pwb.py replace.py -start:Translations:! "https://sourceforge.net/apps/phpbb/free-cad" "http://forum.freecad.org"}}

== FreeCAD Wiki Related Commands ==
Count all pages that a specific wiki templates is used in

{{SystemInput|python3 pwb.py templatecount -count GuiCommand}} 


List all pages that a specific wiki templates is used in

{{SystemInput|python3 pwb.py templatecount -list GuiCommand}} 

Replace a string in all the pages listed in the Arch category

{{SystemInput|python3 pwb.py replace.py -cat:Arch}}
[[Category:Administration{{#translation:}}]]
[[Category:Developer{{#translation:}}]]