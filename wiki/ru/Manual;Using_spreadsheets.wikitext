<languages/>

{{Docnav/ru
|[[Manual:BIM_modeling/ru|Моделирование BIM]]
|[[Manual:Creating_FEM_analyses/ru|Создание анализа методом конечных элементов]]
|[[Manual:Introduction/ru|Руководство: Начало]]
|IconC=Crystal_Clear_manual.png
}}

{{Manual:TOC}}

[[Image:Workbench_Spreadsheet.svg|16px]] [[Spreadsheet_Workbench/ru|Верстак Электронная Таблица (Spreadsheet)]] во FreeCAD позволяет пользователям создавать и управлять [https://en.wikipedia.org/wiki/Spreadsheet электронными таблицами (англ.)], например, созданными в [https://en.wikipedia.org/wiki/Microsoft_Excel Excel] или [https://en.wikipedia.org/wiki/LibreOffice_Calc Calc в LibreOffice], непосредственно в своих проектах. Это позволяет вводить, организовывать и манипулировать данными в формате таблицы, которые затем могут быть связаны с различными параметрами и моделями в проекте.

Одно из ключевых преимуществ - это их использование в параметрическом моделировании. Электронные таблицы могут быть связаны с размерами и свойствами 3D-моделей, что делает их незаменимым инструментом для динамического изменения конструкции. Например, при изменении значения в электронной таблице автоматически обновляется соответствующий размер в модели.

Помимо управления значениями, верстак отлично подходит для управления данными, сохраняя такую важную информацию, как свойства материалов, размеры и параметры всего проекта. Это становится особенно полезным в сложных проектах, где необходимо ссылаться на множество значений или корректировать их.

Электронные таблицы также позволяют пользователям вводить формулы для расчётов и управления данными. Эти формулы могут ссылаться на другие ячейки электронных таблиц или параметры в 3D-модели, что делает весь процесс проектирования адаптируемым и учитывающим изменения.

Он может легко интегрироваться с другими рабочими инструментами FreeCAD, обеспечивая взаимодействие между данными и компонентами модели. Такая интеграция централизует контроль над различными аспектами проекта, облегчая управление им. Интерфейс прост и напоминает традиционные электронные таблицы, что делает его знакомым и простым в использовании для тех, кто уже привык к таким программам, как Excel или LibreOffice Calc.

На практике верстак Электронных Таблиц (Spreadsheet) универсален для различных случаев использования, включая определение параметров всего проекта, управление спецификациями материалов (BOM) и выполнение пользовательских вычислений, влияющих на проектные решения. Он упрощает сложные проекты, централизуя управление параметрами в одном месте.

В следующем примере мы создадим несколько объектов, сохраним некоторые их свойства в электронной таблице, а затем будем использовать эту таблицу для непосредственного управления свойствами других объектов.

<span id="Reading_properties"></span>
=== Чтение свойств ===

* Начни с перехода в [[Image:Workbench_Part.svg|16px]] [[Part_Workbench/ru|Верстак Деталь (Part)]] и создай пару объектов: [[Image:Part_Box.svg|16px]] [[Part_Box/ru|куб]], [[Image:Part_Cylinder.svg|16px]] [[Part_Cylinder/ru|цилиндр]] и [[Image:Part_Sphere.svg|16px]] [[Part_Sphere/ru|сферу]].
* Отредактируй их свойство '''Placement - Размещение''' (или используй инструмент [[Image:Draft_Move.svg|16px]] [[Draft_Move/ru|Набросок Переместить]]), чтобы разместить их на некотором расстоянии друг от друга, так мы сможем лучше увидеть эффект от того, что мы будем делать:

[[Image:Exercise_spreadsheet_01.jpg]]

* Теперь давайте извлечём немного информации об этих объектах. Переключись на [[Image:Workbench_Spreadsheet.svg|16px]] [[Spreadsheet_Workbench/ru|Верстак Электронная таблица (Spreadsheet )]]
* Нажми кнопку [[Image:Spreadsheet_Create.svg|16px]] '''Создать электронную таблицу'''
* Дважды щёлкни новый объект Spreadsheet в дереве проекта. Откроется редактор электронных таблиц:

[[File:FreeCAD Spreedsheet.png]]

Хотя редактор электронных таблиц FreeCAD не так многофункционален, как специализированные приложения вроде Excel или LibreOffice Calc, он предоставляет необходимые инструменты для большинства задач проектирования. Пользователи могут настраивать свойства ячеек, такие как размер, цвет и выравнивание, а также объединять или разделять ячейки для лучшей организации. Поддерживаются основные формулы и ссылки на другие ячейки, что позволяет легко манипулировать данными. Отличительной особенностью программы является глубокая интеграция со средой моделирования FreeCAD, где изменения в электронной таблице могут автоматически обновлять размеры модели в режиме реального времени. Несмотря на отсутствие таких продвинутых функций, как сводные таблицы или диаграммы, ориентированность на параметрическое проектирование делает её мощным инструментом для управления проектными данными непосредственно в FreeCAD.

В FreeCAD, помимо стандартных возможностей электронных таблиц, есть особенно полезная функция: возможность ссылаться не только на другие ячейки, но и на объекты внутри документа и извлекать значения из их свойств. Например, вы можете извлекать свойства из 3D-объектов, которые видны на вкладке '''Данные (Data)''' редактора свойств, когда объект выбран. Это обеспечивает бесшовную интеграцию между электронной таблицей и 3D-моделью, позволяя легко связывать и автоматизировать изменения на основе параметров объектов в проекте, предлагая более динамичный и взаимосвязанный рабочий процесс.

Переведено с помощью DeepL.com (бесплатная версия)

* Давай начнём с ввода текста в ячейки A1, A2 и A3, чтобы в дальнейшем не забыть, что к чему, например, '''Длина куба''', '''Радиус цилиндра''' и '''Радиус сферы'''. Чтобы ввести текст, просто напишите в поле "Содержание" над электронной таблицей или дважды щёлкни по ячейке.
* Теперь давайте получим фактическую длину нашего куба. В ячейке B1 введите '''=Cube.Length'''. Вы заметите, что в электронной таблице есть механизм автозаполнения, который на самом деле такой же, как и редактор выражений, который мы использовали в предыдущей главе.
* Сделайте то же самое для ячеек B2 ('''=Cylinder.Radius''') и B3 ('''=Sphere.Radius''').

[[File:FreeCAD Spreedsheet Autocomplete.png]]

* Хотя эти результаты выражены в единицах измерения, значениями можно манипулировать как любыми числами, например, ввести в ячейку C1: '''=B1*2'''.
* Теперь мы можем изменить одно из этих значений в редакторе свойств, и это изменение немедленно отразится в электронной таблице. Например, давайте изменим длину нашего куба на '''20 мм''':

[[File:FreeCAD Spreedsheet Multipl.png]]

На странице [[Image:Workbench_Spreadsheet.svg|16px]] [[Spreadsheet_Workbench/ru| Верстака Электронная Таблица (Spreadsheet)]] будут более подробно описаны все возможные операции и функции, доступные в электронных таблицах.

<span id="Writing_properties"></span>
=== Запись свойств ===

<div class="mw-translate-fuzzy">
* Теперь закроем вкладку таблицы (в трёхмерном окне). Это не обязательно, можно и оставить несколько таблиц открытыми.
* Нажмём снова кнопку [[Image:Spreadsheet_Create.png|16px]] '''New Spreadsheet'''
* Изменим имя новой таблицы на что-то более содержательное, вроде '''Ввод''' (это делается правым кликом на новой таблице и выбором '''Переименовать''').
* Откроем редактор таблиц двойным кликом по таблице '''Ввод'''.
* В ячейке A1 поместим описание, например: "Размеры Куба"
* В ячейке B1 напишем '''=5mm''' (использование знака "=" гарантирует, что значение будет понято как величина, а не текст).
* Теперь, чтобы использовать это значение за пределами таблицы, надо дать имя ячейке B1 псевдоним. Сделаем правый клик на ячейке, нажмём '''Свойства''' и выделим вкладку '''Псевдоним'''. Дадим имя, например, '''cubedims''':
</div>

* We can now close the spreadsheet tab (under the 3D view). This is not mandatory, there is no problem in keeping several spreadsheet windows open.
* Press the [[Image:Spreadsheet_Create.svg|16px]] '''New Spreadsheet''' button again
* Change the name of the new spreadsheet to something more meaningful, such as '''Input''' (do this by right-clicking the new spreadsheet object, and choosing '''Rename''').
* Double-click the Input spreadsheet to open the spreadsheet editor.
* In cell A1, let's put a descriptive text, for example: "Cube dimensions"
* In cell B1, write '''=5mm''' (using the = sign makes sure the value is interpreted as a unit value, not a text).
* Now to be able to use this value outside the spreadsheet, we need to give a name, or alias, to the B1 cell.  Right-click the cell, click '''Properties''' and select the '''Alias''' tab. Give it a name, such as '''cubedims''':

<div class="mw-translate-fuzzy">
* Нажмём '''OK''' и закроем вкладку таблицы
* Выделим куб
* В редакторе параметров кликнем маленькую иконку [[Image:Bound-expression-unset.png|16px]] '''expression''' справа от поля '''Length'''. Это откроет [[Expressions/ru|редактор выражений]], где мы сможем написать '''Spreadsheet001.cubedims'''. Повторим это для Height и Width:
</div>

* Press '''OK''', then close the spreadsheet tab
* Select the cube object
* In the properties editor, click the little [[Image:Bound-expression-unset.svg|16px]] '''expression''' icon at the right side of the '''Length''' field. This will open the [[Expressions|expressions editor]], where you can write '''Spreadsheet001.cubedims'''. Repeat this for '''Height''' and '''Width''':

<div class="mw-translate-fuzzy">
Вы можете удивиться, почему нам понадобилось использовать в выражении "Spreadsheet001" вместо "Ввод". Это потому, что каждый объект в документе FreeCAD имеет '''внутреннее имя''', уникальное для документа, и '''метку''', видимую в древе проекта. Если Вы снимите соответствующую опцию в настройках, FreeCAD позволит давать одноименные метки для разных объектов. Поэтому все операции, которые должны однозначно идентифицировать объекты, используют внутренние имена вместо меток, которые могут обозначать разные объекты. Проще всего узнать внутренние имена объектов оставлять открытой панель '''просмотр выделения''' (меню Вид->Панели), она всегда показывает внутреннее имя выбранного объекта:
</div>

The reason we use "Spreadsheet001" instead of "Input" in the expression is that every object in a FreeCAD document has a unique internal name and a more user-friendly label. While the label is what appears in the tree view, the internal name is used to uniquely identify objects within the document. FreeCAD allows you to assign the same label to multiple objects if you adjust your preferences, but the internal name remains unique. For any operation that requires identifying an object without ambiguity, FreeCAD uses the internal name rather than the label, as the label could refer to more than one object. To find the internal name of an object, it's useful to keep the Selection Panel (accessible via View → Panels) open. This panel will always display the internal name of the selected object, ensuring you use the correct reference in your expressions.

<div class="mw-translate-fuzzy">
Используя в таблицах псевдонимы ячеек мы можем использовать таблицы для хранения "основных значений" в документах FreeCAD. Это может использоваться, например, для моделей различных размеров, сохраняя эти размеры в таблице. Становится лёгким создавать другие модели с различными размерами, просто открыв файл и изменив набор размеров в таблице.
</div>

<div class="mw-translate-fuzzy">
В итоге заметьте, что ограничения внутри эскизов так же могут получать значения из табличных ячеек:
</div>

Finally, note that the constraints inside a sketch can also receive the value of a spreadsheet cell:

Так же можно создать псевдонимы для размерных ограничений (горизонтальных, вертикальных или по расстояниям) в эскизах (которые так же можно использовать за пределами эскизов)

[[File:FreeCAD SpreedSheet Rectangle.png]]

'''Загрузки'''

* Файл, полученный в этом примере: https://github.com/yorikvanhavre/FreeCAD-manual/blob/master/files/spreadsheet.FCStd

'''Читать далее'''

* [[Spreadsheet_Workbench/ru|Верстак Spreadsheet]]
* [[Expressions/ru|Использование выражений в параметрах]]


<div class="mw-translate-fuzzy">
{{Docnav/ru
|[[Manual:BIM modeling/ru|BIM modeling]]
|[[Manual:Creating FEM analyses/ru|Creating FEM analyses]]
|[[Manual:Introduction/ru|Manual start]]
|IconC=Crystal Clear manual.png
}}
</div>

[[Category:Tutorials{{#translation:}}]]